[2025-03-16T23:28:22.626+0000] {local_task_job_runner.py:123} INFO - ::group::Pre task execution logs
[2025-03-16T23:28:22.634+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: lab1StockETL.extract scheduled__2025-03-15T02:30:00+00:00 [queued]>
[2025-03-16T23:28:22.637+0000] {taskinstance.py:2612} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: lab1StockETL.extract scheduled__2025-03-15T02:30:00+00:00 [queued]>
[2025-03-16T23:28:22.637+0000] {taskinstance.py:2865} INFO - Starting attempt 1 of 1
[2025-03-16T23:28:22.641+0000] {taskinstance.py:2888} INFO - Executing <Task(_PythonDecoratedOperator): extract> on 2025-03-15 02:30:00+00:00
[2025-03-16T23:28:22.652+0000] {standard_task_runner.py:104} INFO - Running: ['***', 'tasks', 'run', 'lab1StockETL', 'extract', 'scheduled__2025-03-15T02:30:00+00:00', '--job-id', '27', '--raw', '--subdir', 'DAGS_FOLDER/lab1_ETL.py', '--cfg-path', '/tmp/tmp4h02240i']
[2025-03-16T23:28:22.652+0000] {logging_mixin.py:190} WARNING - /home/***/.local/lib/python3.12/site-packages/***/task/task_runner/standard_task_runner.py:70 DeprecationWarning: This process (pid=1726) is multi-threaded, use of fork() may lead to deadlocks in the child.
[2025-03-16T23:28:22.653+0000] {standard_task_runner.py:105} INFO - Job 27: Subtask extract
[2025-03-16T23:28:22.653+0000] {standard_task_runner.py:72} INFO - Started process 1732 to run task
[2025-03-16T23:28:22.693+0000] {task_command.py:467} INFO - Running <TaskInstance: lab1StockETL.extract scheduled__2025-03-15T02:30:00+00:00 [running]> on host 38f3b8d675df
[2025-03-16T23:28:22.734+0000] {taskinstance.py:3131} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='lab1StockETL' AIRFLOW_CTX_TASK_ID='extract' AIRFLOW_CTX_EXECUTION_DATE='2025-03-15T02:30:00+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2025-03-15T02:30:00+00:00'
[2025-03-16T23:28:22.735+0000] {taskinstance.py:731} INFO - ::endgroup::
[2025-03-16T23:28:22.737+0000] {logging_mixin.py:190} INFO - YF.download() has changed argument auto_adjust default to True
[2025-03-16T23:28:23.420+0000] {logging_mixin.py:190} WARNING - [*********************100%***********************]  1 of 1 completed
[2025-03-16T23:28:23.541+0000] {logging_mixin.py:190} WARNING - [*********************100%***********************]  1 of 1 completed
[2025-03-16T23:28:23.543+0000] {python.py:240} INFO - Done. Returned value was: {'NVDA': Price            Close        High         Low        Open     Volume
Ticker            NVDA        NVDA        NVDA        NVDA       NVDA
Date                                                                 
2024-06-26  126.368858  128.088428  122.569792  126.098921  362975900
2024-06-27  123.959442  126.378852  122.889706  124.069416  252571700
2024-06-28  123.509560  127.678530  122.719753  124.549304  315516700
2024-07-01  124.269386  124.809247  118.800732  123.439589  284885500
2024-07-02  122.639771  123.379594  121.000175  121.100149  218374000
...                ...         ...         ...         ...        ...
2025-03-10  106.970161  111.839709  105.450297  109.889891  366487400
2025-03-11  108.750000  112.229676  104.760361  106.980159  354865700
2025-03-12  115.739998  116.760002  112.879997  114.120003  323857500
2025-03-13  115.580002  117.760002  113.790001  117.029999  299033100
2025-03-14  121.669998  121.879997  118.150002  118.610001  276742800

[180 rows x 5 columns], 'AAPL': Price            Close        High         Low        Open    Volume
Ticker            AAPL        AAPL        AAPL        AAPL      AAPL
Date                                                                
2024-06-26  212.535690  214.140298  209.934432  210.791552  66213200
2024-06-27  213.382843  215.017349  211.638705  213.970863  49772700
2024-06-28  209.914474  215.346231  209.595554  215.047232  82542700
2024-07-01  216.023956  216.781405  211.210133  211.379562  60402900
2024-07-02  219.532166  219.641798  214.379485  215.425956  58046200
...                ...         ...         ...         ...       ...
2025-03-10  227.479996  236.160004  224.220001  235.539993  72071200
2025-03-11  220.839996  225.839996  217.449997  223.809998  76137400
2025-03-12  216.979996  221.750000  214.910004  220.139999  62547500
2025-03-13  209.679993  216.839996  208.419998  215.949997  61368300
2025-03-14  213.490005  213.949997  209.580002  211.250000  60060200

[180 rows x 5 columns]}
[2025-03-16T23:28:23.633+0000] {taskinstance.py:340} INFO - ::group::Post task execution logs
[2025-03-16T23:28:23.633+0000] {taskinstance.py:352} INFO - Marking task as SUCCESS. dag_id=lab1StockETL, task_id=extract, run_id=scheduled__2025-03-15T02:30:00+00:00, execution_date=20250315T023000, start_date=20250316T232822, end_date=20250316T232823
[2025-03-16T23:28:23.662+0000] {local_task_job_runner.py:266} INFO - Task exited with return code 0
[2025-03-16T23:28:23.685+0000] {taskinstance.py:3925} ERROR - Error scheduling downstream tasks. Skipping it as this is entirely optional optimisation. There might be various reasons for it, please take a look at the stack trace to figure out if the root cause can be diagnosed and fixed. See the issue https://github.com/apache/***/issues/39717 for details and an example problem. If you would like to get help in solving root cause, open discussion with all details with your managed service support or in Airflow repository.
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3921, in schedule_downstream_tasks
    return TaskInstance._schedule_downstream_tasks(
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/utils/session.py", line 94, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/taskinstance.py", line 3870, in _schedule_downstream_tasks
    partial_dag = task.dag.partial_subset(
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 2664, in partial_subset
    t.task_id: _deepcopy_task(t)
               ^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/dag.py", line 2661, in _deepcopy_task
    return copy.deepcopy(t, memo)
           ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 143, in deepcopy
    y = copier(memo)
        ^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.12/site-packages/airflow/models/baseoperator.py", line 1388, in __deepcopy__
    setattr(result, k, copy.deepcopy(v, memo))
                       ^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 221, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
                             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 201, in _deepcopy_tuple
    y = [deepcopy(a, memo) for a in x]
         ^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 259, in _reconstruct
    state = deepcopy(state, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 221, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
                             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 162, in deepcopy
    y = _reconstruct(x, memo, *rv)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 259, in _reconstruct
    state = deepcopy(state, memo)
            ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 136, in deepcopy
    y = copier(x, memo)
        ^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 221, in _deepcopy_dict
    y[deepcopy(key, memo)] = deepcopy(value, memo)
                             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/lib/python3.12/copy.py", line 151, in deepcopy
    rv = reductor(4)
         ^^^^^^^^^^^
TypeError: cannot pickle '_thread.lock' object
[2025-03-16T23:28:23.688+0000] {local_task_job_runner.py:245} INFO - ::endgroup::
